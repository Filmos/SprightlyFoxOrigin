
let monument_materials = {"Base":{"compactmachines:wall":{"Stability":0.7,"Potential":1},"minecraft:iron_block":{"Stability":1.8,"Potential":1},"tconstruct:pig_iron_block":{"Stability":2.1,"Potential":1.2,"Decay":0.2},"tconstruct:slimesteel_block":{"Stability":2.3,"Potential":1.1},"minecraft:ancient_debris":{"Stability":6,"Potential":1.1},"byg:pendorite_block":{"Stability":12,"Potential":1.4},"byg:ametrine_block":{"Stability":10,"Potential":1.8},"minecraft:netherite_block":{"Stability":30,"Potential":1.8},"minecraft:coal_block":{"Stability":0.5,"Potential":1.1},"minecraft:obsidian":{"Stability":1,"Potential":1.2},"minecraft:lapis_block":{"Stability":0.4,"Potential":1.3},"minecraft:redstone_block":{"Stability":0.3,"Potential":1.6},"minecraft:quartz_block":{"Stability":0.6,"Potential":1.4},"minecraft:gold_block":{"Stability":1.2,"Potential":2},"tconstruct:rose_gold_block":{"Stability":0.2,"Potential":4.2},"materialis:fairy_block":{"Stability":1.4,"Potential":2.2},"minecraft:crying_obsidian":{"Stability":1,"Potential":2.8},"minecraft:emerald_block":{"Stability":1.8,"Potential":2.6},"minecraft:diamond_block":{"Stability":3.8,"Potential":2.2},"twilightforest:arctic_fur_block":{"Stability":1.5,"Potential":1.5},"twilightforest:ironwood_block":{"Stability":1.6,"Potential":1.3},"tconstruct:tinkers_bronze_block":{"Stability":1.3,"Potential":1.3},"tconstruct:copper_block":{"Stability":1.3,"Potential":1.2},"create:brass_block":{"Stability":1.5,"Potential":1.1},"create:zinc_block":{"Stability":1.6,"Potential":1},"twilightforest:steeleaf_block":{"Stability":2.5,"Potential":1.2},"twilightforest:carminite_block":{"Stability":0.2,"Potential":6,"Dimensional Stability":-1.2},"tconstruct:hepatizon_block":{"Stability":3.4,"Potential":2},"tconstruct:cobalt_block":{"Stability":3.2,"Potential":2.4},"tconstruct:manyullyn_block":{"Stability":5.8,"Potential":2.7},"tconstruct:queens_slime_block":{"Stability":2,"Potential":2.5},"twilightforest:fiery_block":{"Stability":10,"Potential":4.2,"Heat":2.4},"twilightforest:knightmetal_block":{"Stability":4.2,"Potential":2.6},"create:shadow_steel_casing":{"Stability":2.8,"Potential":1.6,"Dimensional Stability":-0.7},"create:refined_radiance_casing":{"Stability":2.6,"Potential":1.8,"Dimensional Stability":0.7},"overloaded_cb:compressed_wall_1":{"Stability":0.9,"Potential":1},"overloaded_cb:compressed_wall_2":{"Stability":1.3,"Potential":1},"overloaded_cb:compressed_wall_3":{"Stability":1.9,"Potential":1},"overloaded_cb:compressed_wall_4":{"Stability":2.9,"Potential":1},"overloaded_cb:compressed_wall_5":{"Stability":4.7,"Potential":1},"overloaded_cb:compressed_wall_6":{"Stability":7.6,"Potential":1},"overloaded_cb:compressed_wall_7":{"Stability":12.7,"Potential":1},"overloaded_cb:compressed_wall_8":{"Stability":21.3,"Potential":1},"overloaded_cb:compressed_wall_9":{"Stability":36,"Potential":1},"overloaded_cb:compressed_iron_block_1":{"Stability":2.8,"Potential":1},"overloaded_cb:compressed_iron_block_2":{"Stability":4.4,"Potential":1},"overloaded_cb:compressed_iron_block_3":{"Stability":7.3,"Potential":1},"overloaded_cb:compressed_iron_block_4":{"Stability":12.1,"Potential":1},"overloaded_cb:compressed_iron_block_5":{"Stability":20.3,"Potential":1},"overloaded_cb:compressed_iron_block_6":{"Stability":34.2,"Potential":1},"overloaded_cb:compressed_iron_block_7":{"Stability":57.8,"Potential":1},"overloaded_cb:compressed_iron_block_8":{"Stability":98.1,"Potential":1},"overloaded_cb:compressed_iron_block_9":{"Stability":166.4,"Potential":1},"overloaded_cb:compressed_pig_iron_block_1":{"Stability":3.3,"Potential":1.3,"Decay":0.3},"overloaded_cb:compressed_pig_iron_block_2":{"Stability":5.3,"Potential":1.6,"Decay":0.5},"overloaded_cb:compressed_pig_iron_block_3":{"Stability":8.8,"Potential":2,"Decay":0.7},"overloaded_cb:compressed_pig_iron_block_4":{"Stability":14.6,"Potential":2.7,"Decay":1},"overloaded_cb:compressed_pig_iron_block_5":{"Stability":24.5,"Potential":3.8,"Decay":1.5},"overloaded_cb:compressed_pig_iron_block_6":{"Stability":41.4,"Potential":5.8,"Decay":2.3},"overloaded_cb:compressed_pig_iron_block_7":{"Stability":70.2,"Potential":9.2,"Decay":3.4},"overloaded_cb:compressed_pig_iron_block_8":{"Stability":119,"Potential":15,"Decay":5.1},"overloaded_cb:compressed_pig_iron_block_9":{"Stability":202,"Potential":24.7,"Decay":7.7},"overloaded_cb:compressed_slimesteel_block_1":{"Stability":3.6,"Potential":1.2},"overloaded_cb:compressed_slimesteel_block_2":{"Stability":5.9,"Potential":1.3},"overloaded_cb:compressed_slimesteel_block_3":{"Stability":9.7,"Potential":1.5},"overloaded_cb:compressed_slimesteel_block_4":{"Stability":16.3,"Potential":1.8},"overloaded_cb:compressed_slimesteel_block_5":{"Stability":27.4,"Potential":2.4},"overloaded_cb:compressed_slimesteel_block_6":{"Stability":46.3,"Potential":3.4},"overloaded_cb:compressed_slimesteel_block_7":{"Stability":78.4,"Potential":5.1},"overloaded_cb:compressed_slimesteel_block_8":{"Stability":132.9,"Potential":8},"overloaded_cb:compressed_slimesteel_block_9":{"Stability":225.7,"Potential":12.9},"overloaded_cb:compressed_ancient_debris_1":{"Stability":9.9,"Potential":1.2},"overloaded_cb:compressed_ancient_debris_2":{"Stability":16.6,"Potential":1.3},"overloaded_cb:compressed_ancient_debris_3":{"Stability":27.9,"Potential":1.5},"overloaded_cb:compressed_ancient_debris_4":{"Stability":47.2,"Potential":1.8},"overloaded_cb:compressed_ancient_debris_5":{"Stability":79.9,"Potential":2.4},"overloaded_cb:compressed_ancient_debris_6":{"Stability":135.6,"Potential":3.4},"overloaded_cb:compressed_ancient_debris_7":{"Stability":230.2,"Potential":5.1},"overloaded_cb:compressed_ancient_debris_8":{"Stability":391,"Potential":8},"overloaded_cb:compressed_ancient_debris_9":{"Stability":664.5,"Potential":12.9},"overloaded_cb:compressed_pendorite_block_1":{"Stability":20.1,"Potential":1.7},"overloaded_cb:compressed_pendorite_block_2":{"Stability":33.9,"Potential":2.2},"overloaded_cb:compressed_pendorite_block_3":{"Stability":57.4,"Potential":3},"overloaded_cb:compressed_pendorite_block_4":{"Stability":97.3,"Potential":4.3},"overloaded_cb:compressed_pendorite_block_5":{"Stability":165.1,"Potential":6.7},"overloaded_cb:compressed_pendorite_block_6":{"Stability":280.4,"Potential":10.7},"overloaded_cb:compressed_pendorite_block_7":{"Stability":476.4,"Potential":17.4},"overloaded_cb:compressed_pendorite_block_8":{"Stability":809.6,"Potential":28.9},"overloaded_cb:compressed_pendorite_block_9":{"Stability":1376,"Potential":48.4},"overloaded_cb:compressed_ametrine_block_1":{"Stability":16.7,"Potential":2.4},"overloaded_cb:compressed_ametrine_block_2":{"Stability":28.1,"Potential":3.3},"overloaded_cb:compressed_ametrine_block_3":{"Stability":47.6,"Potential":4.9},"overloaded_cb:compressed_ametrine_block_4":{"Stability":80.6,"Potential":7.7},"overloaded_cb:compressed_ametrine_block_5":{"Stability":136.7,"Potential":12.4},"overloaded_cb:compressed_ametrine_block_6":{"Stability":232.1,"Potential":20.3},"overloaded_cb:compressed_ametrine_block_7":{"Stability":394.3,"Potential":33.8},"overloaded_cb:compressed_ametrine_block_8":{"Stability":670.1,"Potential":56.8},"overloaded_cb:compressed_ametrine_block_9":{"Stability":1138.8,"Potential":95.9},"overloaded_cb:compressed_netherite_block_1":{"Stability":50.7,"Potential":2.4},"overloaded_cb:compressed_netherite_block_2":{"Stability":85.9,"Potential":3.3},"overloaded_cb:compressed_netherite_block_3":{"Stability":145.8,"Potential":4.9},"overloaded_cb:compressed_netherite_block_4":{"Stability":247.6,"Potential":7.7},"overloaded_cb:compressed_netherite_block_5":{"Stability":420.7,"Potential":12.4},"overloaded_cb:compressed_netherite_block_6":{"Stability":714.9,"Potential":20.3},"overloaded_cb:compressed_netherite_block_7":{"Stability":1215,"Potential":33.8},"overloaded_cb:compressed_netherite_block_8":{"Stability":2065.2,"Potential":56.8},"overloaded_cb:compressed_netherite_block_9":{"Stability":3510.6,"Potential":95.9},"overloaded_cb:compressed_coal_block_1":{"Stability":0.6,"Potential":1.2},"overloaded_cb:compressed_coal_block_2":{"Stability":0.7,"Potential":1.3},"overloaded_cb:compressed_coal_block_3":{"Stability":0.9,"Potential":1.5},"overloaded_cb:compressed_coal_block_4":{"Stability":1.2,"Potential":1.8},"overloaded_cb:compressed_coal_block_5":{"Stability":1.8,"Potential":2.4},"overloaded_cb:compressed_coal_block_6":{"Stability":2.8,"Potential":3.4},"overloaded_cb:compressed_coal_block_7":{"Stability":4.5,"Potential":5.1},"overloaded_cb:compressed_coal_block_8":{"Stability":7.4,"Potential":8},"overloaded_cb:compressed_coal_block_9":{"Stability":12.3,"Potential":12.9},"overloaded_cb:compressed_obsidian_1":{"Stability":1.4,"Potential":1.3},"overloaded_cb:compressed_obsidian_2":{"Stability":2.1,"Potential":1.6},"overloaded_cb:compressed_obsidian_3":{"Stability":3.3,"Potential":2},"overloaded_cb:compressed_obsidian_4":{"Stability":5.4,"Potential":2.7},"overloaded_cb:compressed_obsidian_5":{"Stability":8.9,"Potential":3.8},"overloaded_cb:compressed_obsidian_6":{"Stability":14.9,"Potential":5.8},"overloaded_cb:compressed_obsidian_7":{"Stability":25,"Potential":9.2},"overloaded_cb:compressed_obsidian_8":{"Stability":42.3,"Potential":15},"overloaded_cb:compressed_obsidian_9":{"Stability":71.6,"Potential":24.7},"overloaded_cb:compressed_lapis_block_1":{"Stability":0.4,"Potential":1.5},"overloaded_cb:compressed_lapis_block_2":{"Stability":0.4,"Potential":1.9},"overloaded_cb:compressed_lapis_block_3":{"Stability":0.4,"Potential":2.5},"overloaded_cb:compressed_lapis_block_4":{"Stability":0.4,"Potential":3.5},"overloaded_cb:compressed_lapis_block_5":{"Stability":0.4,"Potential":5.3},"overloaded_cb:compressed_lapis_block_6":{"Stability":0.4,"Potential":8.2},"overloaded_cb:compressed_lapis_block_7":{"Stability":0.4,"Potential":13.3},"overloaded_cb:compressed_lapis_block_8":{"Stability":0.4,"Potential":21.9},"overloaded_cb:compressed_lapis_block_9":{"Stability":0.4,"Potential":36.6},"overloaded_cb:compressed_redstone_block_1":{"Stability":0.3,"Potential":2},"overloaded_cb:compressed_redstone_block_2":{"Stability":0.3,"Potential":2.7},"overloaded_cb:compressed_redstone_block_3":{"Stability":0.3,"Potential":3.9},"overloaded_cb:compressed_redstone_block_4":{"Stability":0.4,"Potential":6},"overloaded_cb:compressed_redstone_block_5":{"Stability":0.4,"Potential":9.5},"overloaded_cb:compressed_redstone_block_6":{"Stability":0.4,"Potential":15.5},"overloaded_cb:compressed_redstone_block_7":{"Stability":0.4,"Potential":25.6},"overloaded_cb:compressed_redstone_block_8":{"Stability":0.4,"Potential":42.9},"overloaded_cb:compressed_redstone_block_9":{"Stability":0.4,"Potential":72.2},"overloaded_cb:compressed_quartz_block_1":{"Stability":0.7,"Potential":1.7},"overloaded_cb:compressed_quartz_block_2":{"Stability":1,"Potential":2.2},"overloaded_cb:compressed_quartz_block_3":{"Stability":1.4,"Potential":3},"overloaded_cb:compressed_quartz_block_4":{"Stability":2.1,"Potential":4.3},"overloaded_cb:compressed_quartz_block_5":{"Stability":3.2,"Potential":6.7},"overloaded_cb:compressed_quartz_block_6":{"Stability":5.2,"Potential":10.7},"overloaded_cb:compressed_quartz_block_7":{"Stability":8.6,"Potential":17.4},"overloaded_cb:compressed_quartz_block_8":{"Stability":14.4,"Potential":28.9},"overloaded_cb:compressed_quartz_block_9":{"Stability":24.1,"Potential":48.4},"overloaded_cb:compressed_gold_block_1":{"Stability":1.8,"Potential":2.7},"overloaded_cb:compressed_gold_block_2":{"Stability":2.7,"Potential":3.9},"overloaded_cb:compressed_gold_block_3":{"Stability":4.3,"Potential":5.9},"overloaded_cb:compressed_gold_block_4":{"Stability":7.1,"Potential":9.4},"overloaded_cb:compressed_gold_block_5":{"Stability":11.8,"Potential":15.2},"overloaded_cb:compressed_gold_block_6":{"Stability":19.7,"Potential":25.1},"overloaded_cb:compressed_gold_block_7":{"Stability":33.2,"Potential":42},"overloaded_cb:compressed_gold_block_8":{"Stability":56.2,"Potential":70.8},"overloaded_cb:compressed_gold_block_9":{"Stability":95.3,"Potential":119.6},"overloaded_cb:compressed_rose_gold_block_1":{"Stability":0.2,"Potential":6.4},"overloaded_cb:compressed_rose_gold_block_2":{"Stability":0.3,"Potential":10.2},"overloaded_cb:compressed_rose_gold_block_3":{"Stability":0.3,"Potential":16.7},"overloaded_cb:compressed_rose_gold_block_4":{"Stability":0.3,"Potential":27.7},"overloaded_cb:compressed_rose_gold_block_5":{"Stability":0.3,"Potential":46.4},"overloaded_cb:compressed_rose_gold_block_6":{"Stability":0.3,"Potential":78.2},"overloaded_cb:compressed_rose_gold_block_7":{"Stability":0.4,"Potential":132.3},"overloaded_cb:compressed_rose_gold_block_8":{"Stability":0.4,"Potential":224.2},"overloaded_cb:compressed_rose_gold_block_9":{"Stability":0.4,"Potential":380.5},"overloaded_cb:compressed_fairy_block_1":{"Stability":2.1,"Potential":3},"overloaded_cb:compressed_fairy_block_2":{"Stability":3.3,"Potential":4.5},"overloaded_cb:compressed_fairy_block_3":{"Stability":5.3,"Potential":6.9},"overloaded_cb:compressed_fairy_block_4":{"Stability":8.8,"Potential":11},"overloaded_cb:compressed_fairy_block_5":{"Stability":14.6,"Potential":18},"overloaded_cb:compressed_fairy_block_6":{"Stability":24.5,"Potential":30},"overloaded_cb:compressed_fairy_block_7":{"Stability":41.4,"Potential":50.2},"overloaded_cb:compressed_fairy_block_8":{"Stability":70.2,"Potential":84.7},"overloaded_cb:compressed_fairy_block_9":{"Stability":119,"Potential":143.3},"overloaded_cb:compressed_crying_obsidian_1":{"Stability":1.4,"Potential":4.1},"overloaded_cb:compressed_crying_obsidian_2":{"Stability":2.1,"Potential":6.2},"overloaded_cb:compressed_crying_obsidian_3":{"Stability":3.3,"Potential":9.8},"overloaded_cb:compressed_crying_obsidian_4":{"Stability":5.4,"Potential":16},"overloaded_cb:compressed_crying_obsidian_5":{"Stability":8.9,"Potential":26.6},"overloaded_cb:compressed_crying_obsidian_6":{"Stability":14.9,"Potential":44.4},"overloaded_cb:compressed_crying_obsidian_7":{"Stability":25,"Potential":74.9},"overloaded_cb:compressed_crying_obsidian_8":{"Stability":42.3,"Potential":126.6},"overloaded_cb:compressed_crying_obsidian_9":{"Stability":71.6,"Potential":214.5},"overloaded_cb:compressed_emerald_block_1":{"Stability":2.8,"Potential":3.7},"overloaded_cb:compressed_emerald_block_2":{"Stability":4.4,"Potential":5.6},"overloaded_cb:compressed_emerald_block_3":{"Stability":7.3,"Potential":8.9},"overloaded_cb:compressed_emerald_block_4":{"Stability":12.1,"Potential":14.4},"overloaded_cb:compressed_emerald_block_5":{"Stability":20.3,"Potential":23.7},"overloaded_cb:compressed_emerald_block_6":{"Stability":34.2,"Potential":39.6},"overloaded_cb:compressed_emerald_block_7":{"Stability":57.8,"Potential":66.7},"overloaded_cb:compressed_emerald_block_8":{"Stability":98.1,"Potential":112.6},"overloaded_cb:compressed_emerald_block_9":{"Stability":166.4,"Potential":190.7},"overloaded_cb:compressed_diamond_block_1":{"Stability":6.2,"Potential":3},"overloaded_cb:compressed_diamond_block_2":{"Stability":10.2,"Potential":4.5},"overloaded_cb:compressed_diamond_block_3":{"Stability":17.1,"Potential":6.9},"overloaded_cb:compressed_diamond_block_4":{"Stability":28.8,"Potential":11},"overloaded_cb:compressed_diamond_block_5":{"Stability":48.7,"Potential":18},"overloaded_cb:compressed_diamond_block_6":{"Stability":82.5,"Potential":30},"overloaded_cb:compressed_diamond_block_7":{"Stability":139.9,"Potential":50.2},"overloaded_cb:compressed_diamond_block_8":{"Stability":237.6,"Potential":84.7},"overloaded_cb:compressed_diamond_block_9":{"Stability":403.6,"Potential":143.3},"overloaded_cb:compressed_arctic_fur_block_1":{"Stability":2.3,"Potential":1.9},"overloaded_cb:compressed_arctic_fur_block_2":{"Stability":3.6,"Potential":2.4},"overloaded_cb:compressed_arctic_fur_block_3":{"Stability":5.8,"Potential":3.5},"overloaded_cb:compressed_arctic_fur_block_4":{"Stability":9.6,"Potential":5.2},"overloaded_cb:compressed_arctic_fur_block_5":{"Stability":16,"Potential":8.1},"overloaded_cb:compressed_arctic_fur_block_6":{"Stability":27,"Potential":13.1},"overloaded_cb:compressed_arctic_fur_block_7":{"Stability":45.5,"Potential":21.5},"overloaded_cb:compressed_arctic_fur_block_8":{"Stability":77.1,"Potential":35.9},"overloaded_cb:compressed_arctic_fur_block_9":{"Stability":130.8,"Potential":60.3},"overloaded_cb:compressed_ironwood_block_1":{"Stability":2.4,"Potential":1.5},"overloaded_cb:compressed_ironwood_block_2":{"Stability":3.9,"Potential":1.9},"overloaded_cb:compressed_ironwood_block_3":{"Stability":6.3,"Potential":2.5},"overloaded_cb:compressed_ironwood_block_4":{"Stability":10.4,"Potential":3.5},"overloaded_cb:compressed_ironwood_block_5":{"Stability":17.4,"Potential":5.3},"overloaded_cb:compressed_ironwood_block_6":{"Stability":29.4,"Potential":8.2},"overloaded_cb:compressed_ironwood_block_7":{"Stability":49.6,"Potential":13.3},"overloaded_cb:compressed_ironwood_block_8":{"Stability":84.1,"Potential":21.9},"overloaded_cb:compressed_ironwood_block_9":{"Stability":142.7,"Potential":36.6},"overloaded_cb:compressed_tinkers_bronze_block_1":{"Stability":1.9,"Potential":1.5},"overloaded_cb:compressed_tinkers_bronze_block_2":{"Stability":3,"Potential":1.9},"overloaded_cb:compressed_tinkers_bronze_block_3":{"Stability":4.8,"Potential":2.5},"overloaded_cb:compressed_tinkers_bronze_block_4":{"Stability":7.9,"Potential":3.5},"overloaded_cb:compressed_tinkers_bronze_block_5":{"Stability":13.2,"Potential":5.3},"overloaded_cb:compressed_tinkers_bronze_block_6":{"Stability":22.1,"Potential":8.2},"overloaded_cb:compressed_tinkers_bronze_block_7":{"Stability":37.3,"Potential":13.3},"overloaded_cb:compressed_tinkers_bronze_block_8":{"Stability":63.2,"Potential":21.9},"overloaded_cb:compressed_tinkers_bronze_block_9":{"Stability":107.1,"Potential":36.6},"overloaded_cb:compressed_copper_block_1":{"Stability":1.9,"Potential":1.3},"overloaded_cb:compressed_copper_block_2":{"Stability":3,"Potential":1.6},"overloaded_cb:compressed_copper_block_3":{"Stability":4.8,"Potential":2},"overloaded_cb:compressed_copper_block_4":{"Stability":7.9,"Potential":2.7},"overloaded_cb:compressed_copper_block_5":{"Stability":13.2,"Potential":3.8},"overloaded_cb:compressed_copper_block_6":{"Stability":22.1,"Potential":5.8},"overloaded_cb:compressed_copper_block_7":{"Stability":37.3,"Potential":9.2},"overloaded_cb:compressed_copper_block_8":{"Stability":63.2,"Potential":15},"overloaded_cb:compressed_copper_block_9":{"Stability":107.1,"Potential":24.7},"overloaded_cb:compressed_brass_block_1":{"Stability":2.3,"Potential":1.2},"overloaded_cb:compressed_brass_block_2":{"Stability":3.6,"Potential":1.3},"overloaded_cb:compressed_brass_block_3":{"Stability":5.8,"Potential":1.5},"overloaded_cb:compressed_brass_block_4":{"Stability":9.6,"Potential":1.8},"overloaded_cb:compressed_brass_block_5":{"Stability":16,"Potential":2.4},"overloaded_cb:compressed_brass_block_6":{"Stability":27,"Potential":3.4},"overloaded_cb:compressed_brass_block_7":{"Stability":45.5,"Potential":5.1},"overloaded_cb:compressed_brass_block_8":{"Stability":77.1,"Potential":8},"overloaded_cb:compressed_brass_block_9":{"Stability":130.8,"Potential":12.9},"overloaded_cb:compressed_zinc_block_1":{"Stability":2.4,"Potential":1},"overloaded_cb:compressed_zinc_block_2":{"Stability":3.9,"Potential":1},"overloaded_cb:compressed_zinc_block_3":{"Stability":6.3,"Potential":1},"overloaded_cb:compressed_zinc_block_4":{"Stability":10.4,"Potential":1},"overloaded_cb:compressed_zinc_block_5":{"Stability":17.4,"Potential":1},"overloaded_cb:compressed_zinc_block_6":{"Stability":29.4,"Potential":1},"overloaded_cb:compressed_zinc_block_7":{"Stability":49.6,"Potential":1},"overloaded_cb:compressed_zinc_block_8":{"Stability":84.1,"Potential":1},"overloaded_cb:compressed_zinc_block_9":{"Stability":142.7,"Potential":1},"overloaded_cb:compressed_steeleaf_block_1":{"Stability":4,"Potential":1.3},"overloaded_cb:compressed_steeleaf_block_2":{"Stability":6.5,"Potential":1.6},"overloaded_cb:compressed_steeleaf_block_3":{"Stability":10.7,"Potential":2},"overloaded_cb:compressed_steeleaf_block_4":{"Stability":17.9,"Potential":2.7},"overloaded_cb:compressed_steeleaf_block_5":{"Stability":30.2,"Potential":3.8},"overloaded_cb:compressed_steeleaf_block_6":{"Stability":51.1,"Potential":5.8},"overloaded_cb:compressed_steeleaf_block_7":{"Stability":86.6,"Potential":9.2},"overloaded_cb:compressed_steeleaf_block_8":{"Stability":146.9,"Potential":15},"overloaded_cb:compressed_steeleaf_block_9":{"Stability":249.4,"Potential":24.7},"overloaded_cb:compressed_carminite_block_1":{"Stability":0.2,"Potential":9.5,"Dimensional Stability":-1.8},"overloaded_cb:compressed_carminite_block_2":{"Stability":0.3,"Potential":15.5,"Dimensional Stability":-2.7},"overloaded_cb:compressed_carminite_block_3":{"Stability":0.3,"Potential":25.6,"Dimensional Stability":-4},"overloaded_cb:compressed_carminite_block_4":{"Stability":0.3,"Potential":42.8,"Dimensional Stability":-6.1},"overloaded_cb:compressed_carminite_block_5":{"Stability":0.3,"Potential":72,"Dimensional Stability":-9.1},"overloaded_cb:compressed_carminite_block_6":{"Stability":0.3,"Potential":121.7,"Dimensional Stability":-13.7},"overloaded_cb:compressed_carminite_block_7":{"Stability":0.4,"Potential":206.2,"Dimensional Stability":-20.5},"overloaded_cb:compressed_carminite_block_8":{"Stability":0.4,"Potential":349.8,"Dimensional Stability":-30.8},"overloaded_cb:compressed_carminite_block_9":{"Stability":0.4,"Potential":593.9,"Dimensional Stability":-46.1},"overloaded_cb:compressed_hepatizon_block_1":{"Stability":5.5,"Potential":2.7},"overloaded_cb:compressed_hepatizon_block_2":{"Stability":9.1,"Potential":3.9},"overloaded_cb:compressed_hepatizon_block_3":{"Stability":15.1,"Potential":5.9},"overloaded_cb:compressed_hepatizon_block_4":{"Stability":25.5,"Potential":9.4},"overloaded_cb:compressed_hepatizon_block_5":{"Stability":43,"Potential":15.2},"overloaded_cb:compressed_hepatizon_block_6":{"Stability":72.8,"Potential":25.1},"overloaded_cb:compressed_hepatizon_block_7":{"Stability":123.5,"Potential":42},"overloaded_cb:compressed_hepatizon_block_8":{"Stability":209.7,"Potential":70.8},"overloaded_cb:compressed_hepatizon_block_9":{"Stability":356.2,"Potential":119.6},"overloaded_cb:compressed_cobalt_block_1":{"Stability":5.2,"Potential":3.4},"overloaded_cb:compressed_cobalt_block_2":{"Stability":8.5,"Potential":5},"overloaded_cb:compressed_cobalt_block_3":{"Stability":14.2,"Potential":7.9},"overloaded_cb:compressed_cobalt_block_4":{"Stability":23.8,"Potential":12.7},"overloaded_cb:compressed_cobalt_block_5":{"Stability":40.2,"Potential":20.9},"overloaded_cb:compressed_cobalt_block_6":{"Stability":68,"Potential":34.8},"overloaded_cb:compressed_cobalt_block_7":{"Stability":115.3,"Potential":58.4},"overloaded_cb:compressed_cobalt_block_8":{"Stability":195.7,"Potential":98.7},"overloaded_cb:compressed_cobalt_block_9":{"Stability":332.4,"Potential":167},"overloaded_cb:compressed_manyullyn_block_1":{"Stability":9.6,"Potential":3.9},"overloaded_cb:compressed_manyullyn_block_2":{"Stability":16,"Potential":5.9},"overloaded_cb:compressed_manyullyn_block_3":{"Stability":26.9,"Potential":9.4},"overloaded_cb:compressed_manyullyn_block_4":{"Stability":45.5,"Potential":15.2},"overloaded_cb:compressed_manyullyn_block_5":{"Stability":77.1,"Potential":25.1},"overloaded_cb:compressed_manyullyn_block_6":{"Stability":130.7,"Potential":42},"overloaded_cb:compressed_manyullyn_block_7":{"Stability":222,"Potential":70.8},"overloaded_cb:compressed_manyullyn_block_8":{"Stability":377.1,"Potential":119.6},"overloaded_cb:compressed_manyullyn_block_9":{"Stability":640.8,"Potential":202.6},"overloaded_cb:compressed_queens_slime_block_1":{"Stability":3.1,"Potential":3.6},"overloaded_cb:compressed_queens_slime_block_2":{"Stability":5,"Potential":5.3},"overloaded_cb:compressed_queens_slime_block_3":{"Stability":8.3,"Potential":8.4},"overloaded_cb:compressed_queens_slime_block_4":{"Stability":13.8,"Potential":13.5},"overloaded_cb:compressed_queens_slime_block_5":{"Stability":23.1,"Potential":22.3},"overloaded_cb:compressed_queens_slime_block_6":{"Stability":39,"Potential":37.2},"overloaded_cb:compressed_queens_slime_block_7":{"Stability":66.1,"Potential":62.6},"overloaded_cb:compressed_queens_slime_block_8":{"Stability":112,"Potential":105.6},"overloaded_cb:compressed_queens_slime_block_9":{"Stability":190.1,"Potential":178.9},"overloaded_cb:compressed_fiery_block_1":{"Stability":16.7,"Potential":6.4,"Heat":3.6},"overloaded_cb:compressed_fiery_block_2":{"Stability":28.1,"Potential":10.2,"Heat":5.4},"overloaded_cb:compressed_fiery_block_3":{"Stability":47.6,"Potential":16.7,"Heat":8.1},"overloaded_cb:compressed_fiery_block_4":{"Stability":80.6,"Potential":27.7,"Heat":12.2},"overloaded_cb:compressed_fiery_block_5":{"Stability":136.7,"Potential":46.4,"Heat":18.2},"overloaded_cb:compressed_fiery_block_6":{"Stability":232.1,"Potential":78.2,"Heat":27.3},"overloaded_cb:compressed_fiery_block_7":{"Stability":394.3,"Potential":132.3,"Heat":41},"overloaded_cb:compressed_fiery_block_8":{"Stability":670.1,"Potential":224.2,"Heat":61.5},"overloaded_cb:compressed_fiery_block_9":{"Stability":1138.8,"Potential":380.5,"Heat":92.3},"overloaded_cb:compressed_knightmetal_block_1":{"Stability":6.9,"Potential":3.7},"overloaded_cb:compressed_knightmetal_block_2":{"Stability":11.4,"Potential":5.6},"overloaded_cb:compressed_knightmetal_block_3":{"Stability":19.1,"Potential":8.9},"overloaded_cb:compressed_knightmetal_block_4":{"Stability":32.1,"Potential":14.4},"overloaded_cb:compressed_knightmetal_block_5":{"Stability":54.4,"Potential":23.7},"overloaded_cb:compressed_knightmetal_block_6":{"Stability":92.1,"Potential":39.6},"overloaded_cb:compressed_knightmetal_block_7":{"Stability":156.3,"Potential":66.7},"overloaded_cb:compressed_knightmetal_block_8":{"Stability":265.5,"Potential":112.6},"overloaded_cb:compressed_knightmetal_block_9":{"Stability":451,"Potential":190.7},"overloaded_cb:compressed_shadow_steel_casing_1":{"Stability":4.5,"Potential":2,"Dimensional Stability":-1},"overloaded_cb:compressed_shadow_steel_casing_2":{"Stability":7.3,"Potential":2.7,"Dimensional Stability":-1.6},"overloaded_cb:compressed_shadow_steel_casing_3":{"Stability":12.2,"Potential":3.9,"Dimensional Stability":-2.4},"overloaded_cb:compressed_shadow_steel_casing_4":{"Stability":20.4,"Potential":6,"Dimensional Stability":-3.5},"overloaded_cb:compressed_shadow_steel_casing_5":{"Stability":34.5,"Potential":9.5,"Dimensional Stability":-5.3},"overloaded_cb:compressed_shadow_steel_casing_6":{"Stability":58.3,"Potential":15.5,"Dimensional Stability":-8},"overloaded_cb:compressed_shadow_steel_casing_7":{"Stability":98.9,"Potential":25.6,"Dimensional Stability":-12},"overloaded_cb:compressed_shadow_steel_casing_8":{"Stability":167.8,"Potential":42.9,"Dimensional Stability":-17.9},"overloaded_cb:compressed_shadow_steel_casing_9":{"Stability":285,"Potential":72.2,"Dimensional Stability":-26.9},"overloaded_cb:compressed_refined_radiance_casing_1":{"Stability":4.1,"Potential":2.4,"Dimensional Stability":1},"overloaded_cb:compressed_refined_radiance_casing_2":{"Stability":6.8,"Potential":3.3,"Dimensional Stability":1.6},"overloaded_cb:compressed_refined_radiance_casing_3":{"Stability":11.2,"Potential":4.9,"Dimensional Stability":2.4},"overloaded_cb:compressed_refined_radiance_casing_4":{"Stability":18.8,"Potential":7.7,"Dimensional Stability":3.5},"overloaded_cb:compressed_refined_radiance_casing_5":{"Stability":31.6,"Potential":12.4,"Dimensional Stability":5.3},"overloaded_cb:compressed_refined_radiance_casing_6":{"Stability":53.5,"Potential":20.3,"Dimensional Stability":8},"overloaded_cb:compressed_refined_radiance_casing_7":{"Stability":90.7,"Potential":33.8,"Dimensional Stability":12},"overloaded_cb:compressed_refined_radiance_casing_8":{"Stability":153.9,"Potential":56.8,"Dimensional Stability":17.9},"overloaded_cb:compressed_refined_radiance_casing_9":{"Stability":261.3,"Potential":95.9,"Dimensional Stability":26.9}},"Top":{"minecraft:daylight_detector":{"Stability":1.4,"Potential":0},"minecraft:sea_lantern":{"Stability":1.2,"Potential":0.3},"byg:blue_glowcane_block":{"Stability":0.9,"Potential":0.5},"byg:purple_glowcane_block":{"Stability":0.8,"Potential":0.6},"byg:pink_glowcane_block":{"Stability":0.6,"Potential":0.7},"byg:red_glowcane_block":{"Stability":0.5,"Potential":0.8},"minecraft:glowstone":{"Stability":0.4,"Potential":0.9},"minecraft:lantern":{"Stability":0.1,"Potential":0.7},"minecraft:soul_lantern":{"Stability":0.1,"Potential":1.1},"minecraft:end_rod":{"Stability":0.2,"Potential":1.5},"minecraft:enchanting_table":{"Stability":2,"Potential":0.8,"Spread":0.3},"minecraft:beacon":{"Stability":1.7,"Potential":1,"Spread":1},"minecraft:end_portal_frame":{"Stability":3.6,"Potential":2,"Dimensional Stability":0.4},"minecraft:creeper_head":{"Stability":0.7,"Potential":1.1,"Decay":0.2},"minecraft:zombie_head":{"Stability":0.7,"Potential":1.3,"Decay":0.5},"minecraft:skeleton_skull":{"Stability":0.9,"Potential":1.1,"Decay":0.5},"minecraft:wither_skeleton_skull":{"Stability":1.2,"Potential":1.8,"Decay":1.6},"twilightforest:naga_trophy":{"Stability":1.3,"Potential":0.8},"twilightforest:lich_trophy":{"Stability":0.9,"Potential":1.2},"twilightforest:minoshroom_trophy":{"Stability":1.5,"Potential":1.4},"twilightforest:quest_ram_trophy":{"Stability":1.3,"Potential":1.6},"twilightforest:knight_phantom_trophy":{"Stability":1.8,"Potential":1.3,"Decay":-0.3},"twilightforest:yeti_trophy":{"Stability":1.2,"Potential":1.2,"Heat":-1},"twilightforest:snow_queen_trophy":{"Stability":1.4,"Potential":1.4,"Heat":-3.6},"twilightforest:hydra_trophy":{"Stability":3.4,"Potential":2.8,"Heat":2.4},"twilightforest:ur_ghast_trophy":{"Stability":-1.4,"Potential":4.2},"minecraft:dragon_head":{"Stability":2.4,"Potential":1.8,"Dimensional Stability":-0.3},"minecraft:campfire":{"Stability":0.5,"Potential":1.1,"Heat":0.4},"minecraft:soul_campfire":{"Stability":0.7,"Potential":0.8,"Heat":0.2},"byg:boric_campfire":{"Stability":0.4,"Potential":0.7,"Heat":0.4,"Decay":-0.5},"byg:cryptic_campfire":{"Stability":0.6,"Potential":1.4,"Heat":0.9}}}
let monument_shape = [
  [ 0,  0,  0, "Top" , 1],
  [ 0, -1,  0, "Base", 1.5],
  [ 0, -2,  0, "Base", 1.2],
  [ 0, -3,  0, "Base", 1.2],
  
  [ 0, -4,  0, "Base", 0.7],
  [-1, -4,  0, "Base", 0.7],
  [ 1, -4,  0, "Base", 0.7],
  [ 0, -4,  1, "Base", 0.7],
  [ 0, -4, -1, "Base", 0.7],
  
  [-2, -3,  0, "Base", 1.0],
  [ 2, -3,  0, "Base", 1.0],
  [ 0, -3,  2, "Base", 1.0],
  [ 0, -3, -2, "Base", 1.0],
  
  [-2, -2,  0, "Top", 0.7],
  [ 2, -2,  0, "Top", 0.7],
  [ 0, -2,  2, "Top", 0.7],
  [ 0, -2, -2, "Top", 0.7],
]

function loadNbtStorage(player) {
  let nbt = player.getFullNBT().ForgeCaps["origins:origin_component"].Powers
  let ret = {}
  for(let n in nbt) ret[nbt[n].Type] = nbt[n].Data
  return ret
}
function saveNbtStorage(player, data) {
  let dat = []
  for(let k in data) dat.push({Type: k, Data: data[k]})
  let nbt = player.getFullNBT()
  nbt.ForgeCaps["origins:origin_component"].Powers = dat
  player.setFullNBT(nbt)
}

function loadStoredTag(player, tag) {
  let ret = null
  let tags = player.getTags().forEach(t => {
    if(t.indexOf(tag+"-")==0) ret = t.split("-").slice(1).join(":")
  })
  return ret
}
function saveStoredTag(player, tag, value) {
  let toRemove = []
  let tags = player.getTags().forEach(t => {
    if(t.indexOf(tag+"-")==0) toRemove.push(t)
  })
  toRemove.forEach(t => player.server.runCommandSilent("/tag "+player.name+" remove "+t))
  player.server.runCommandSilent("/tag "+player.name+" add "+tag+"-"+value.replaceAll(":", "-"))
}


function getMonumentPos(player, type) {
  let dim = loadStoredTag(player, type+"PosD")
  let nbt = loadNbtStorage(player)
  let pref = "sprightly_fox:the_split_"+type+"Pos"
  return {x: nbt[pref+"X"]/10, y: nbt[pref+"Y"]/10, z: nbt[pref+"Z"]/10, d: dim}
}
function setMonumentPos(player, type, value) {
  let nbt = loadNbtStorage(player)
  let pref = "sprightly_fox:the_split_"+type+"Pos"
  nbt[pref+"X"] = Math.round(value.x*10)
  nbt[pref+"Y"] = Math.round(value.y*10)
  nbt[pref+"Z"] = Math.round(value.z*10)
  saveNbtStorage(player, nbt)
  saveStoredTag(player, type+"PosD", value.d)
}
function getBilocState(player) {
  return loadNbtStorage(player)["sprightly_fox:the_split_BilocState"]
}
function setBilocState(player, state, extraData) {
  extraData = extraData || {}
  let nbt = loadNbtStorage(player)
  nbt["sprightly_fox:the_split_BilocState"] = state
  for(let e in extraData) nbt[e] = extraData[e]
  saveNbtStorage(player, nbt)
}

function displayMonumentStats(rootBlock, player, server, title) {
  let monStats = analyzeMonument(rootBlock, server, true)
  
  if(monStats.missed > 0) {
    server.runCommandSilent('/tellraw '+player.name+' [{"text":"Invalid structure!","color":"dark_red"}]')
  } else {
    let message = '/tellraw '+player.name+' [{"text":"'+title+'","color":"dark_purple"},{"text":"\\nStability: ","color":"gray"},{"text":"'+Math.round(monStats.Stability*10)/10+'","color":"light_purple"},{"text":"\\nPotential: ","color":"gray"},{"text":"'+Math.round(monStats.Potential*10)/10+'","color":"light_purple"}'
    for(let spec in monStats) {
      if(spec == "Stability" || spec == "Potential" || spec == "missed") continue
      message += ',{"text":"\\n'+spec+': ","color":"white"},{"text":"'+Math.round(monStats[spec]*10)/10+'","color":"light_purple"}'
    }
    server.runCommandSilent(message+"]")
  }
  
  return monStats
}
function animateMonument(server, pos, animType) {
  if(animType=="fromMon") server.runCommandSilent(`/execute in ${pos.d} run particle minecraft:end_rod ${pos.x+0.5} ${pos.y} ${pos.z+0.5} 0 0 0 0.1 70`)
  else {
    server.runCommandSilent(`/execute in ${pos.d} run particle minecraft:end_rod ${pos.x+0.5} ${pos.y} ${pos.z+0.5} 0 0 0 1 300`)
    if(animType=="initial") server.runCommandSilent(`/execute in ${pos.d} run particle minecraft:explosion ${pos.x+0.5} ${pos.y-2.5} ${pos.z+0.5} 0 0 0 1 10`)
    for(let dir of [[0, 1], [0, -1], [1, 0], [-1, 0]]) {
      for(let i = 0; i<20; i++) server.runCommandSilent(`/execute in ${pos.d} run particle minecraft:end_rod ${pos.x+dir[0]*i/10+0.5} ${pos.y-i/10+0.75} ${pos.z+dir[1]*i/10+0.5}`)
      if(animType=="initial") server.runCommandSilent(`/execute in ${pos.d} run particle minecraft:explosion ${pos.x+dir[0]*2+0.5} ${pos.y-1.5} ${pos.z+dir[1]*2+0.5}`)
    }
  }
  
  if(animType=="initial") {
    server.runCommandSilent(`/execute in ${pos.d} run playsound minecraft:block.beacon.power_select block @a ${pos.x+0.5} ${pos.y+0.5} ${pos.z+0.5} 3 1.4`)
    server.runCommandSilent(`/execute in ${pos.d} run playsound minecraft:block.beacon.activate block @a ${pos.x+0.5} ${pos.y+0.5} ${pos.z+0.5} 3 0.8`)
  } else {
    server.runCommandSilent(`/execute in ${pos.d} run playsound minecraft:block.beacon.ambient block @a ${pos.x+0.5} ${pos.y+0.5} ${pos.z+0.5} 3 0.8`)
    server.runCommandSilent(`/execute in ${pos.d} run playsound minecraft:block.beacon.ambient block @a ${pos.x+0.5} ${pos.y+0.5} ${pos.z+0.5} 3 0.5`)
  }
}
function analyzeMonument(rootBlock, server, displayMissing) {
  let combined = {Stability: 5, Potential: 1}
  for(let pos of monument_shape) { 
    let block = rootBlock.offset(pos[0], pos[1], pos[2])
    
    mat = monument_materials[pos[3]][block.getId()]
    if(!mat) {
      if(displayMissing) {
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x-0.1)+' '+(block.y)+' '+(block.z-0.1))
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x-0.1)+' '+(block.y)+' '+(block.z))
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x-0.1)+' '+(block.y)+' '+(block.z+1.1))
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x)+' '+(block.y)+' '+(block.z-0.1))
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x)+' '+(block.y)+' '+(block.z+1.1))
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x+1.1)+' '+(block.y)+' '+(block.z-0.1))
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x+1.1)+' '+(block.y)+' '+(block.z))
        server.runCommandSilent('/execute in '+block.getDimension()+' run particle alexsmobs:shocked '+(block.x+1.1)+' '+(block.y)+' '+(block.z+1.1))
      }
      mat = {missed: 1}
    }
    for(let stat in mat) {
      if(!combined[stat]) combined[stat] = 0
      combined[stat] += mat[stat]*pos[4]
    }
  }
  return combined
}


function calcDistance(startPos, endPos) {  
  if(startPos.d == endPos.d) return Math.sqrt((startPos.x-endPos.x)*(startPos.x-endPos.x)+(startPos.y-endPos.y)*(startPos.y-endPos.y)+(startPos.z-endPos.z)*(startPos.z-endPos.z))
  let dimCost = (startPos.d=="minecraft:overworld"?0:500)+(endPos.d=="minecraft:overworld"?0:500)
  
  if(startPos.d=="minecraft:the_end") return dimCost + Math.sqrt(startPos.x*startPos.x+(64-startPos.y)*(64-startPos.y)+startPos.z*startPos.z)
  if(endPos.d=="minecraft:the_end") return dimCost + Math.sqrt(endPos.x*endPos.x+(64-endPos.y)*(64-endPos.y)+endPos.z*endPos.z)
  
  if(startPos.d=="minecraft:the_nether") return dimCost + Math.sqrt((startPos.x-endPos.x/8)*(startPos.x-endPos.x/8)+(startPos.y-endPos.y)*(startPos.y-endPos.y)+(startPos.z-endPos.z/8)*(startPos.z-endPos.z/8))
  if(endPos.d=="minecraft:the_nether") return dimCost + Math.sqrt((startPos.x/8-endPos.x)*(startPos.x/8-endPos.x)+(startPos.y-endPos.y)*(startPos.y-endPos.y)+(startPos.z/8-endPos.z)*(startPos.z/8-endPos.z))
  
  return dimCost + Math.sqrt((startPos.x-endPos.x)*(startPos.x-endPos.x)+(startPos.y-endPos.y)*(startPos.y-endPos.y)+(startPos.z-endPos.z)*(startPos.z-endPos.z))
}
function calcSeverity(safeP, p, subP) {
  subP = subP || 1
  if(subP <= 0.01) return 0
  if(subP != 1) p = p*(Math.log2(subP+0.32)/2+0.8)+safeP*(subP-1)*0.075
  if(p<safeP) return 0
  let rand = Math.random()
  return Math.max(0,-1.27247*Math.log2((-2436*safeP*(rand+0.392857))/(1150*safeP-2800*p))-1)
}

let monument_sideEffects = {
  "Heat": (server, selector, severity) => {
    if(severity > 0) server.runCommandSilent(`/execute at ${selector} run summon minecraft:lightning_bolt`)
    if(severity <= 1) return
    
    let uid = Math.floor(Math.random()*100)
    server.runCommandSilent(`/tag ${selector} add TheSplit.Overheated${uid}`)
    for(let i=1;i<=Math.floor(severity);i++) server.scheduleInTicks(15*i, server, callback => {server.runCommandSilent(`/execute at @e[tag=TheSplit.Overheated${uid}] run summon minecraft:lightning_bolt`)})
    server.scheduleInTicks(15*Math.floor(severity)+5, server, callback => {server.runCommandSilent(`/tag @e[tag=TheSplit.Overheated${uid}] remove TheSplit.Overheated${uid}`)})
  },
  "-Heat": (server, selector, severity) => {if(severity>0) server.runCommandSilent(`/effect give ${selector} mowziesmobs:frozen ${Math.floor(severity*5)}`)},
  "Decay": (server, selector, severity) => {if(severity>0) server.runCommandSilent(`/effect give ${selector} minecraft:wither ${Math.floor(severity*5)} ${Math.floor(severity/2)}`)}
}
function applySideEffects(server, selector, stats, dist) {
  let severity = calcSeverity(stats.Stability*stats.Stability, dist)
  if(severity > 0) server.runCommandSilent(`/effect give ${selector} minecraft:slowness ${4+Math.round(6*severity)} ${Math.floor(severity)}`)
  if(severity > 0) server.runCommandSilent(`/effect give ${selector} minecraft:weakness ${4+Math.round(6*severity)} ${Math.floor(severity/2)}`)
  if(severity > 1) server.runCommandSilent(`/effect give ${selector} minecraft:mining_fatigue ${4+Math.round(6*severity)} ${Math.floor((severity-1)/2)}`)
  if(severity > 1) server.runCommandSilent(`/effect give ${selector} minecraft:blindness ${Math.round(3*severity)}`)
  if(severity > 2) server.runCommandSilent(`/effect give ${selector} minecraft:hunger ${2+Math.round(4*severity)} ${Math.floor(severity)}`)
  if(severity > 3) server.runCommandSilent(`/effect give ${selector} minecraft:poison ${2+Math.round(4*severity)} ${Math.floor((severity-3)/2)}`)
  if(severity > 4) server.runCommandSilent(`/effect give ${selector} alexsmobs:ender_flu ${Math.max(20,Math.round(300-45*(severity-4)))} ${Math.floor(severity-4)}`)
  
  for(let spec in stats) {
    if(spec == "Stability" || spec == "Potential" || spec == "missed") continue
    if(stats[spec]>0 && monument_sideEffects[spec]) monument_sideEffects[spec](server, selector, calcSeverity(stats.Stability*stats.Stability, dist, stats[spec]))
    if(stats[spec]<0 && monument_sideEffects["-"+spec]) monument_sideEffects["-"+spec](server, selector, calcSeverity(stats.Stability*stats.Stability, dist, -stats[spec]))
  }
}

// Teleportation trigger
events.listen('player.tick', function (event) {
  if (event.player.server && event.player.ticksExisted % 10 === 0) {
    if(!event.player.getPotionEffects().isActive("minecraft:levitation")
    || event.server.runCommandSilent("origin has power "+event.player.name+" sprightly_fox:the_split")==0) return
    if(loadNbtStorage(event.player)["sprightly_fox:the_split_Teleport"]<2000) return
    
    event.server.scheduleInTicks(7, event.server, callback => {
      let pos = getMonumentPos(event.player, "Mon"); if(!pos.d) return
      let retPos = {
        x: event.player.x-0.5,
        y: event.player.y-0.5,
        z: event.player.z-0.5,
        d: event.player.getWorld().getDimension()
      }
      
      let block = event.server.getWorld(pos.d); if(!block) return
      block = block.getBlock(pos.x, pos.y, pos.z)
      let monStats = analyzeMonument(block, event.server, false)
      
      let toMon = getBilocState(event.player)
      let dimStab = monStats["Dimensional Stability"] || 0
      let randTp = (dimStab > 0
        ?(Math.random()<0.1-dimStab/100)
        :(Math.random()<1-0.9/(1-dimStab*0.8))
      )
      if(randTp) {
        let randPlayer = event.server.getPlayers()
        randPlayer = randPlayer[Math.floor(Math.random()*randPlayer.length)]
        let retPos = {
          x: randPlayer.x-0.5,
          y: randPlayer.y-0.5,
          z: randPlayer.z-0.5,
          d: randPlayer.getWorld().getDimension()
        }
        if(toMon == 1) setMonumentPos(event.player, "Ret", retPos)
        toMon = 1
        event.server.scheduleInTicks(3, event.server, callback => {animateMonument(event.server, pos, "fromMon")})
      } else if(toMon == 1) {
        let animPos = {x: pos.x, y: pos.y, z: pos.z, d: pos.d}
        event.server.scheduleInTicks(3, event.server, callback => {animateMonument(event.server, animPos, "toMon")})
        pos.y++
        setMonumentPos(event.player, "Ret", retPos)
      } else {
        pos = getMonumentPos(event.player, "Ret"); if(!pos.d) return
        event.server.scheduleInTicks(3, event.server, callback => {animateMonument(event.server, pos, "fromMon")})
      }
      event.server.runCommandSilent("/effect clear "+event.player.name+" minecraft:levitation")
      event.server.runCommandSilent(`/execute at ${event.player.name} run tag @e[distance=..${Math.round((monStats.Spread||0)*10)/10}] add TheSplit.MidTeleport`)
      event.server.runCommandSilent(`/execute in ${pos.d} run tp @e[tag=TheSplit.MidTeleport] ${pos.x+0.5} ${pos.y+0.5} ${pos.z+0.5}`)
      let dist = calcDistance(pos, retPos)
      if(monStats.missing > 0) dist*=Math.pow(2, 2+monStats.missing/3)
      let health = event.player.getHealth()/event.player.getMaxHealth()
      if(health < 0.5) dist*=(3-health*4)
      
      applySideEffects(event.server, '@e[tag=TheSplit.MidTeleport]', monStats, dist)
      event.server.runCommandSilent(`/tag @e[tag=TheSplit.MidTeleport] remove TheSplit.MidTeleport`)
      
      let cooldown = monStats.Stability*monStats.Stability*(Math.pow(2, monStats.Potential/10)-1)
      cooldown = 1-cooldown/(dist+cooldown)
      setBilocState(event.player, 1-toMon, {"sprightly_fox:sprightly": 0, "sprightly_fox:the_split_Teleport": Math.round((1-cooldown)*2000)})
    })
    
  }
})


// Monument activation/stat check
onEvent('block.right_click', event => {
	if(event.item.getId() != 'rftoolsbase:infused_diamond') return
  if(event.server.runCommandSilent("origin has power "+event.player.name+" sprightly_fox:the_split")==0) return
  
  
  let curMon = getMonumentPos(event.player, "Mon")
  let isActive = (curMon.d == event.block.getDimension() && curMon.x == event.block.x && curMon.y == event.block.y && curMon.z == event.block.z)
  let stats = displayMonumentStats(event.block, event.player, event.server, 'MONUMENT '+(isActive?"ACTIVE":"CREATED"))
  
  if(!(stats.missed > 0) && !isActive) {
    if(event.item.count == 1) event.server.runCommandSilent('/replaceitem entity '+event.player.name+' weapon.mainhand minecraft:air')
    else event.server.runCommandSilent('/replaceitem entity '+event.player.name+' weapon.mainhand rftoolsbase:infused_diamond '+(event.item.count-1))
    
    let newPos = {
      x: event.block.x,
      y: event.block.y,
      z: event.block.z,
      d: event.block.getDimension()
    }
    setMonumentPos(event.player, "Mon", newPos)
    animateMonument(event.server, newPos, "initial")
    setBilocState(event.player, 1)
  }
	
})